<!-- 
  Este fragmento debe agregarse al pom.xml principal del proyecto siv-admin
  para configurar la ejecución de las pruebas unitarias ubicadas en la carpeta tests/
-->

<!-- Agregar esta configuración dentro de la sección <build><plugins> -->

<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.22.2</version>
    <configuration>
        <!-- Incluir pruebas de la carpeta tests -->
        <testSourceDirectory>${project.basedir}/tests</testSourceDirectory>
        <includes>
            <include>**/*Test.java</include>
            <include>**/*Tests.java</include>
        </includes>
        <excludes>
            <exclude>**/Abstract*.java</exclude>
        </excludes>
        <!-- Configuración para JUnit 5 -->
        <useJUnitPlatform>true</useJUnitPlatform>
        <!-- Reportes de pruebas -->
        <reportFormat>xml</reportFormat>
        <reportFormat>plain</reportFormat>
    </configuration>
</plugin>

<!-- Plugin para cobertura de código con JaCoCo -->
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.8.7</version>
    <executions>
        <execution>
            <id>prepare-agent</id>
            <goals>
                <goal>prepare-agent</goal>
            </goals>
        </execution>
        <execution>
            <id>report</id>
            <phase>test</phase>
            <goals>
                <goal>report</goal>
            </goals>
        </execution>
        <execution>
            <id>jacoco-check</id>
            <goals>
                <goal>check</goal>
            </goals>
            <configuration>
                <rules>
                    <rule>
                        <element>PACKAGE</element>
                        <limits>
                            <limit>
                                <counter>LINE</counter>
                                <value>COVEREDRATIO</value>
                                <minimum>0.70</minimum>
                            </limit>
                        </limits>
                    </rule>
                </rules>
            </configuration>
        </execution>
    </executions>
</plugin>

<!-- 
  NOTA IMPORTANTE:
  
  1. Este fragmento debe integrarse en el archivo pom.xml del módulo siv-admin
  
  2. Asegúrate de que las siguientes dependencias estén en el <dependencies>:
     
     - JUnit 5 (Jupiter)
     <dependency>
         <groupId>org.junit.jupiter</groupId>
         <artifactId>junit-jupiter-api</artifactId>
         <version>5.7.0</version>
         <scope>test</scope>
     </dependency>
     <dependency>
         <groupId>org.junit.jupiter</groupId>
         <artifactId>junit-jupiter-engine</artifactId>
         <version>5.7.0</version>
         <scope>test</scope>
     </dependency>
     
     - Mockito (ya está incluido en spring-boot-starter-test)
     <dependency>
         <groupId>org.mockito</groupId>
         <artifactId>mockito-junit-jupiter</artifactId>
         <scope>test</scope>
     </dependency>
     
     - AssertJ (opcional, para assertions más legibles)
     <dependency>
         <groupId>org.assertj</groupId>
         <artifactId>assertj-core</artifactId>
         <version>3.19.0</version>
         <scope>test</scope>
     </dependency>

  3. Para ejecutar las pruebas:
     mvn test
     
  4. Para generar reporte de cobertura:
     mvn clean test jacoco:report
     
  5. El reporte se generará en: target/site/jacoco/index.html
-->

